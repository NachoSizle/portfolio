---
import ThemeToggle from "./ThemeToggle.astro";
import LanguagePicker from "./LanguagePicker.astro";
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const navLinks = [
  { href: "#experience", label: t('nav.experience') },
  { href: "#projects", label: t('nav.projects') },
  { href: "#about", label: t('nav.about') },
  { href: "#contact", label: t('nav.contact') },
];
---

<style>
  :root.dark .scrolled-nav {
    background: rgba(30, 41, 59, 1);
    box-shadow: 0 2px 16px 0 rgba(0, 0, 0, 0.85);
    transition:
      background 0.2s,
      box-shadow 0.2s;
  }

  :root:not(.dark) .scrolled-nav {
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 4px 20px 0 rgba(0, 0, 0, 0.85);
  }
</style>

<header class="sticky top-0 z-200 flex justify-center items-center p-4">
  <nav id="main-nav" class="flex gap-3.5 py-2 px-6 rounded-4xl items-center">
    <!-- Enlaces de navegaciÃ³n (solo desktop) -->
    <div class="hidden md:flex gap-3.5 items-center">
      {
        navLinks.map((link) => (
          <a
            href={link.href}
            class="text-gray-800 dark:text-gray-200 hover:text-gray-900 dark:hover:text-gray-100 select-none"
          >
            {link.label}
          </a>
        ))
      }
    </div>

    <!-- Separador (solo desktop) -->
    <div class="hidden md:block h-6 w-px bg-gray-300 dark:bg-gray-700"></div>

    <!-- Controles (siempre visibles) -->
    <div class="flex gap-3 items-center">
      <LanguagePicker />
      <ThemeToggle />
    </div>
  </nav>
</header>

<script is:inline>
  window.addEventListener("scroll", () => {
    const nav = document.getElementById("main-nav");
    
    if (window.scrollY > 10) {
      nav?.classList.add("scrolled-nav");
    } else {
      nav?.classList.remove("scrolled-nav");
    }
  });
</script>
